<!-- ========================================
     DEMAND FORECAST CAROUSEL MODAL
     Ã€ intÃ©grer dans ton portfolio GitHub
     ======================================== -->

<!-- 1. REMPLACE LE CONTENU DE TA CARD "Demand Planning Table" PAR CECI -->
<div class="project-card demand-forecast-card">
  <div class="project-thumbnail" onclick="openForecastCarousel()">
    <img src="images/demand-forecast/01-dashboard.jpg" alt="Demand Forecast Dashboard">
    <div class="thumbnail-overlay">
      <div class="overlay-content">
        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
          <circle cx="11" cy="11" r="8"></circle>
          <path d="m21 21-4.35-4.35"></path>
          <path d="M11 8v6"></path>
          <path d="M8 11h6"></path>
        </svg>
        <p>Click to explore project</p>
      </div>
    </div>
  </div>
  
  <h3>Demand Forecast Dashboard</h3>
  <p>End-to-end forecasting solution with Power Query, Power Pivot & DAX. Features: 96% accuracy, 5% MAPE, ABC Analysis, seasonal adjustment, and interactive S&OP reporting.</p>
  
  <div class="project-tags">
    <span class="tag">Excel</span>
    <span class="tag">Power Query</span>
    <span class="tag">Power Pivot</span>
    <span class="tag">DAX</span>
    <span class="tag">Forecasting</span>
  </div>
  
  <button class="btn-view-project" onclick="openForecastCarousel()">
    View Full Project
  </button>
</div>


<!-- 2. AJOUTE CE MODAL Ã€ LA FIN DE TON <body>, JUSTE AVANT </body> -->
<div id="forecastCarouselModal" class="carousel-modal">
  <div class="modal-content">
    
    <!-- Close Button -->
    <button class="modal-close" onclick="closeForecastCarousel()" aria-label="Close modal">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="18" y1="6" x2="6" y2="18"></line>
        <line x1="6" y1="6" x2="18" y2="18"></line>
      </svg>
    </button>

    <!-- Carousel Container -->
    <div class="carousel-container">
      
      <!-- Slide 1: Dashboard -->
      <div class="carousel-slide active">
        <div class="slide-content">
          <div class="slide-image">
            <img src="images/demand-forecast/01-dashboard.jpg" alt="Demand Forecast Dashboard">
          </div>
          <div class="slide-info">
            <span class="slide-number">1 / 6</span>
            <h2>Demand Forecast Dashboard</h2>
            <p class="slide-subtitle">Interactive S&OP Reporting</p>
            <div class="slide-description">
              <p><strong>Complete dashboard featuring:</strong></p>
              <ul>
                <li>4 KPIs with conditional formatting (Accuracy 96%, MAPE 5%, Bias 5%)</li>
                <li>Forecast vs Actual comparison (Jan-Nov 2025)</li>
                <li>ABC Analysis with Pareto chart</li>
                <li>Forecast by Category (Sales vs Forecast)</li>
                <li>Monthly variance tracking with color coding</li>
                <li>Top 5 Best/Worst performers analysis</li>
              </ul>
            </div>
            <div class="slide-tech">
              <strong>Tech:</strong> Excel, Power Pivot, DAX, Conditional Formatting
            </div>
          </div>
        </div>
      </div>

      <!-- Slide 2: Parameters -->
      <div class="carousel-slide">
        <div class="slide-content">
          <div class="slide-image">
            <img src="images/demand-forecast/02-parameters.jpg" alt="Forecast Parameters Configuration">
          </div>
          <div class="slide-info">
            <span class="slide-number">2 / 6</span>
            <h2>Configuration Dashboard</h2>
            <p class="slide-subtitle">Dynamic Parameters & Settings</p>
            <div class="slide-description">
              <p><strong>Centralized configuration system:</strong></p>
              <ul>
                <li><strong>Forecast Period:</strong> Rolling date selection (dÃ©c-25)</li>
                <li><strong>Method Selection:</strong> Auto or Manual (Moving Avg, Weighted MA, Exp Smoothing, Seasonal)</li>
                <li><strong>Seasonal Indices:</strong> 12-month table (0.6 to 3.5 for Christmas peak)</li>
                <li><strong>ABC/XYZ Classification:</strong> Revenue & CV thresholds</li>
                <li><strong>KPI Targets:</strong> MAPE <15%, Bias Â±5%, Accuracy >85%</li>
              </ul>
              <p class="highlight">All calculations update dynamically based on these parameters</p>
            </div>
            <div class="slide-tech">
              <strong>Tech:</strong> Excel Tables, Data Validation, Named Ranges
            </div>
          </div>
        </div>
      </div>

      <!-- Slide 3: Power Query -->
      <div class="carousel-slide">
        <div class="slide-content">
          <div class="slide-image">
            <img src="images/demand-forecast/03-power-query.jpg" alt="Power Query Transformations">
          </div>
          <div class="slide-info">
            <span class="slide-number">3 / 6</span>
            <h2>Power Query ETL Pipeline</h2>
            <p class="slide-subtitle">Data Transformation & Cleansing</p>
            <div class="slide-description">
              <p><strong>7 transformation queries:</strong></p>
              <ul>
                <li><strong>Products_Clean:</strong> Product master data with categories</li>
                <li><strong>Sales_Transform:</strong> 480 sales transactions cleaned & formatted</li>
                <li><strong>ABC_Analysis:</strong> Pareto logic with cumulative % calculation</li>
                <li><strong>Lead_Time_Category:</strong> Classification logic</li>
                <li><strong>Price_Category:</strong> Segmentation by price ranges</li>
                <li><strong>Forecast_Metrics:</strong> Aggregated KPIs per product</li>
              </ul>
              <p class="highlight">All queries use M language for optimal performance</p>
            </div>
            <div class="slide-tech">
              <strong>Tech:</strong> Power Query M, Table.Buffer, Table.Group, List functions
            </div>
          </div>
        </div>
      </div>

      <!-- Slide 4: Forecast Engine -->
      <div class="carousel-slide">
        <div class="slide-content">
          <div class="slide-image">
            <img src="images/demand-forecast/04-forecast-engine.jpg" alt="Forecast Calculation Engine">
          </div>
          <div class="slide-info">
            <span class="slide-number">4 / 6</span>
            <h2>Forecast Calculation Engine</h2>
            <p class="slide-subtitle">Multi-Method Forecasting Logic</p>
            <div class="slide-description">
              <p><strong>Multiple forecasting methods implemented:</strong></p>
              <ul>
                <li><strong>Moving Average (3M, 6M):</strong> Simple trend calculation</li>
                <li><strong>Weighted MA:</strong> Recent periods have higher weight (0.5/0.3/0.2)</li>
                <li><strong>Exponential Smoothing:</strong> Alpha 0.3 for smoothing</li>
                <li><strong>Seasonal Adjustment:</strong> Monthly indices applied (3.5x for December)</li>
              </ul>
              <p><strong>Dynamic method selection:</strong></p>
              <ul>
                <li>Auto mode: Selects "Seasonal" if index â‰¥1.5, otherwise "Moving_Avg"</li>
                <li>Manual mode: User specifies method in parameters</li>
              </ul>
              <p class="highlight">All 20 products calculated with safety stock & reorder points</p>
            </div>
            <div class="slide-tech">
              <strong>Tech:</strong> Excel Formulas (MOYENNE.SI, RECHERCHEV, SI), French locale
            </div>
          </div>
        </div>
      </div>

      <!-- Slide 5: Forecast Summary -->
      <div class="carousel-slide">
        <div class="slide-content">
          <div class="slide-image">
            <img src="images/demand-forecast/05-forecast-summary.jpg" alt="12-Month Forecast Summary">
          </div>
          <div class="slide-info">
            <span class="slide-number">5 / 6</span>
            <h2>12-Month Rolling Forecast</h2>
            <p class="slide-subtitle">Monthly Breakdown & Comments</p>
            <div class="slide-description">
              <p><strong>Complete forecast output:</strong></p>
              <ul>
                <li><strong>20 SKUs</strong> across 5 categories</li>
                <li><strong>12 months</strong> of forecast (M0 to M10+)</li>
                <li><strong>Dynamic headers:</strong> Months auto-update based on forecast period parameter</li>
                <li><strong>Formula-driven:</strong> RECHERCHEV pulls seasonal indices from parameters</li>
                <li><strong>Comment tracking:</strong> "Christmas best seller" flags for key products</li>
                <li><strong>Total rows:</strong> 19 700 units historical (Dec-24), 20 721 forecast (Dec-25)</li>
              </ul>
              <p class="highlight">Integrated with FORECAST_ENGINE for automatic calculation</p>
            </div>
            <div class="slide-tech">
              <strong>Tech:</strong> Excel Tables, Structured References, DATE functions
            </div>
          </div>
        </div>
      </div>

      <!-- Slide 6: Power Pivot -->
      <div class="carousel-slide">
        <div class="slide-content">
          <div class="slide-image">
            <img src="images/demand-forecast/06-power-pivot.jpg" alt="Power Pivot Data Model">
          </div>
          <div class="slide-info">
            <span class="slide-number">6 / 6</span>
            <h2>Power Pivot Data Model</h2>
            <p class="slide-subtitle">DAX Measures & Calculated Columns</p>
            <div class="slide-description">
              <p><strong>Data model architecture:</strong></p>
              <ul>
                <li><strong>Fcst_Hist table:</strong> 220 rows (11 months Ã— 20 products)</li>
                <li><strong>Relationships:</strong> Period, SKU, Product, Category</li>
                <li><strong>DAX Calculated Column:</strong> Monthly Variance %
                  <code>= DIVIDE(Forecast - Actual_Sales, Actual_Sales)</code>
                </li>
                <li><strong>Pivot Table:</strong> Monthly aggregation with variance %</li>
              </ul>
              <p><strong>Key results:</strong></p>
              <ul>
                <li>Jan-Sept: 2-4% variance (excellent)</li>
                <li>Oct: 5% variance (good)</li>
                <li>Nov: 10% variance (acceptable for Christmas seasonality)</li>
              </ul>
              <p class="highlight">Powers the "Monthly Forecast Variance" chart in dashboard</p>
            </div>
            <div class="slide-tech">
              <strong>Tech:</strong> Power Pivot, DAX, DIVIDE function, Pivot Tables
            </div>
          </div>
        </div>
      </div>

    </div>

    <!-- Navigation Arrows -->
    <button class="carousel-nav prev" onclick="changeSlide(-1)" aria-label="Previous slide">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="15 18 9 12 15 6"></polyline>
      </svg>
    </button>
    <button class="carousel-nav next" onclick="changeSlide(1)" aria-label="Next slide">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="9 18 15 12 9 6"></polyline>
      </svg>
    </button>

    <!-- Navigation Dots -->
    <div class="carousel-dots">
      <span class="dot active" onclick="goToSlide(0)"></span>
      <span class="dot" onclick="goToSlide(1)"></span>
      <span class="dot" onclick="goToSlide(2)"></span>
      <span class="dot" onclick="goToSlide(3)"></span>
      <span class="dot" onclick="goToSlide(4)"></span>
      <span class="dot" onclick="goToSlide(5)"></span>
    </div>

    <!-- Project Info Footer -->
    <div class="modal-footer">
      <div class="footer-content">
        <div class="footer-left">
          <h4>ðŸ“Š Demand Forecast Dashboard</h4>
          <p>End-to-end Excel forecasting solution | 96% Accuracy | 5% MAPE</p>
        </div>
        <div class="footer-right">
          <button class="btn-download" onclick="requestFile()">
            ðŸ“¥ Request Full File
          </button>
        </div>
      </div>
    </div>

  </div>
</div>
